<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>JARVIS AI</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="jarvis">

  <div class="left">
    <div class="core">J</div>
    <h2>JARVIS</h2>
    <p>System Status: ONLINE</p>
  </div>

  <div class="center">
    <div class="header">JARVIS INTERFACE ACTIVE</div>

    <div id="chatBox" class="chat"></div>

    <div class="controls">
      <input id="input" placeholder="Command JARVIS..." />
      <button onclick="send()">SEND</button>
      <button onclick="image()">IMAGE</button>
    </div>
  </div>

  <div class="right">
    <div class="scan"></div>
  </div>

</div>

<script>
const chat = document.getElementById("chatBox");
const input = document.getElementById("input");

function bubble(cls, txt){
  let div = document.createElement("div");
  div.className = `bubble ${cls}`;
  div.innerText = txt;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

async function send(){
  if(!input.value.trim()) return;
  bubble("human", input.value);
  let q = input.value;
  input.value = "";

  const r = await fetch("/api/chat", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({prompt:q})
  });

  const d = await r.json();
  bubble("ai", d.reply);
}

async function image(){
  if(!input.value.trim()) return;
  bubble("human", "[IMAGE] " + input.value);

  const r = await fetch("/api/generate", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({prompt: input.value})
  });

  const d = await r.json();
  let img = document.createElement("img");
  img.src = "data:image/png;base64," + d.image;
  img.className = "img";
  chat.appendChild(img);
  input.value="";
}

input.addEventListener("keydown", e=>{
  if(e.key==="Enter") send();
});
</script>

</body>
</html>
