<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI-CHATBOT</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<div class="wrapper">

  <div class="sidebar">
    <div class="logo">AI</div>
    <h1>AI-CHATBOT</h1>
    <span>Online</span>
  </div>

  <div class="chat-area">

    <div class="header">Welcome to AI-CHATBOT</div>

    <div id="chatBox"></div>

    <div class="controls">
      <input id="userInput" placeholder="Type your message..." autocomplete="off" />
      <button onclick="sendMessage()">Send</button>
      <button class="stop" onclick="stopAI()">Stop</button>
    </div>

    <div class="upload">
      <input type="file" id="fileInput">
      <button onclick="uploadFile()">Upload</button>
    </div>

  </div>

</div>

<script>
let controller;

function addMessage(role, text){
  const box = document.getElementById("chatBox");
  const msg = document.createElement("div");
  msg.className = role;
  msg.innerText = text;
  box.appendChild(msg);
  box.scrollTop = box.scrollHeight;
}

async function sendMessage(){
  let text = userInput.value.trim();
  if(!text) return;

  addMessage("user", text);
  userInput.value = "";

  controller = new AbortController();

  const res = await fetch("/chat", {
    method:"POST",
    headers:{ "Content-Type":"application/json"},
    body:JSON.stringify({message:text}),
    signal:controller.signal
  });

  const data = await res.json();
  addMessage("ai", data.reply);
}

function stopAI(){
  if(controller) controller.abort();
}

function uploadFile(){
  alert("File scanning not activated yet.");
}

userInput.addEventListener("keydown",(e)=>{
  if(e.key==="Enter") sendMessage();
});
</script>

</body>
</html>
