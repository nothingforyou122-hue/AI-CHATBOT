<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI-CHATBOT</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="app">

  <header>AI-CHATBOT</header>

  <div id="chat"></div>

  <div class="input-bar">

    <label class="file-btn">
      ＋
      <input type="file" id="fileInput" hidden>
    </label>

    <input id="textInput" placeholder="Type a message..." autocomplete="off"/>

    <button id="sendBtn">➤</button>

  </div>

</div>

<script>
let controller;

const input = document.getElementById("textInput");
const chat = document.getElementById("chat");

function addMessage(role, text){
  const div = document.createElement("div");
  div.className = "msg " + role;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

async function sendMessage(){
  const text = input.value.trim();
  if(!text) return;
  
  addMessage("user", text);
  input.value = "";

  controller = new AbortController();

  const res = await fetch("/api/chat", {
    method: "POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({prompt:text}),
    signal: controller.signal
  });

  const data = await res.json();
  addMessage("ai", data.reply || "No response.");
}

document.getElementById("sendBtn").onclick = sendMessage;

input.addEventListener("keydown", e => {
  if(e.key === "Enter") sendMessage();
});

document.getElementById("fileInput").onchange = () => {
  const file = fileInput.files[0];
  if(file) addMessage("user", "Uploaded file: " + file.name);
};
</script>

</body>
</html>
